<Window x:Class="ShortcutEditorWPF.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
        xmlns:local="clr-namespace:ShortcutEditorWPF"
        xmlns:base="clr-namespace:ShortcutEditorWPF.ViewModels"
        xmlns:viewModels="clr-namespace:ShortcutEditorWPF.ViewModels"
        xmlns:utilities1="clr-namespace:ShortcutEditorWPF.Infrastructure.Utilities"
        mc:Ignorable="d"
        ResizeMode="CanMinimize"
        WindowStartupLocation="CenterScreen"
        WindowState="Normal"
        Title="{Binding Title}"
        Width="1160" Height="710" >
    <Window.DataContext>
        <viewModels:MainWindowViewModel/>
    </Window.DataContext>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="0.2*"/>
            <RowDefinition Height="0.16*" />
            <RowDefinition Height="2*"/>
            <RowDefinition Height="0.25*"/>
            <RowDefinition Height="0.02*"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition  Width="0.07*"/>
            <ColumnDefinition  Width="2.0*"/>
            <ColumnDefinition  Width="2.0*"/>
            <ColumnDefinition  Width="3.0*"/>
            <ColumnDefinition  Width="0.07*"/>
        </Grid.ColumnDefinitions>
        <Menu Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="4" Height="25" VerticalAlignment="Center" Padding="3">
            <MenuItem Header="Файл">
                <MenuItem Header="Указать папку" Command="{Binding OpenDirectoryCommand}"></MenuItem>
                <MenuItem Header="Очистить список ярлыков" Command="{Binding ClearListCommand}"></MenuItem>
                <Separator />
                <MenuItem Header="Выход" Command="{Binding CloseApplicationCommand}"></MenuItem>
            </MenuItem>
            <MenuItem Header="Помощь" >
                <MenuItem Header="О программе" ></MenuItem>
            </MenuItem>
        </Menu>
        <DockPanel Grid.Column="1" Grid.Row="1" Grid.ColumnSpan="3" Margin="0 0 2 2">
            <TextBlock DockPanel.Dock="Left" Text="Файл: "
                       Height="25" VerticalAlignment="Center"
                       Margin="0 0 4 2"
                       Padding="4" />
            <TextBlock DockPanel.Dock="Left"
                       Text="{Binding SelectedFile}"
                       Width="300" Height="30" VerticalAlignment="Center"
                       Padding="2 3 2 0"
                       Background="Azure">
                <TextBlock.ContextMenu>
                    <ContextMenu>
                        <MenuItem Header="Копировать" Command="{Binding CopyShortFileNameCommand}" />
                    </ContextMenu>
                </TextBlock.ContextMenu>
            </TextBlock>
            <Button
                DockPanel.Dock="Left"
                Height="30"
                Width="100"
                VerticalAlignment="Center"
                HorizontalAlignment="Left"
                Margin="5 0 0 0 "
                Content="Прочитать"
                Command="{Binding OpenSelectedShortCutCommand}"
                ToolTip="Прочитать свойства выбранного ярлыка" />
        </DockPanel>
        <DockPanel Grid.Column="1" Grid.Row="2" LastChildFill="True" Margin="0 0 2 0">
            <GroupBox DockPanel.Dock="Top" Width="auto" Height="auto" Header="Список ярлыков">
                <b:Interaction.Triggers>
                    <utilities1:DoubleClickEventTrigger  EventName="MouseLeftButtonUp">
                        <b:InvokeCommandAction Command="{Binding OpenSelectedShortCutCommand}" />
                    </utilities1:DoubleClickEventTrigger>
                    <b:EventTrigger EventName="MouseLeftButtonUp">
                        <b:InvokeCommandAction Command="{Binding OpenDirectoryCommand}" />
                    </b:EventTrigger>
                </b:Interaction.Triggers>
                <ListBox ItemsSource="{Binding Files}" DisplayMemberPath="ShortName"
                         SelectedItem="{Binding SelectedFile, Mode=TwoWay}"></ListBox>
                
            </GroupBox>
        </DockPanel>
        <DockPanel Grid.Column="2" Grid.Row="2" LastChildFill="True" Margin="0 0 2 0">
            <GroupBox DockPanel.Dock="Top" Width="auto" Height="auto" Header="Данные выбранного ярлыка" >
                <TextBox DockPanel.Dock="Left"
                         ScrollViewer.HorizontalScrollBarVisibility="Auto"
                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                         ScrollViewer.CanContentScroll="True"
                         TextWrapping="Wrap"
                         Text="{Binding ShortCutData, Mode=OneWay}"
                         Width="auto" Height="auto" VerticalAlignment="Top"
                         Padding="4 8 4 0"
                         Background="Azure"/>
             </GroupBox>       
        </DockPanel>
        <DockPanel Grid.Column="3" Grid.Row="2" LastChildFill="True" Margin="0 0 2 0">
            <GroupBox DockPanel.Dock="Top" Width="auto" Height="auto" Header="Избранные параметры" >
                <StackPanel Orientation="Vertical">
                    <DockPanel Margin="0 0 2 10" DockPanel.Dock="Top" Height="40">
                        <TextBlock DockPanel.Dock="Left" Text="Attribute: "
                                   Margin="0 0 5 0"
                                   Height="25" VerticalAlignment="Bottom"
                                   Padding="4" />
                        <TextBox DockPanel.Dock="Left"
                                   HorizontalAlignment="Left"
                                   Text="{Binding CurrentShortCut.Attribute, Mode=OneWay}"
                                   Width="400" Height="30" VerticalAlignment="Bottom"
                                   Padding="4 8 4 0"
                                   Background="Azure">
                        </TextBox>
                    </DockPanel>
                    <DockPanel Margin="0 0 2 10" DockPanel.Dock="Top" Height="40">
                        <TextBlock DockPanel.Dock="Left" Text="CommonPathSuffix: "
                                   Margin="0 0 5 0"
                                   Height="25" VerticalAlignment="Bottom"
                                   Padding="4" />
                        <TextBox DockPanel.Dock="Left"
                                   HorizontalAlignment="Left"
                                   Text="{Binding CurrentShortCut.Path, Mode=OneWay}"
                                   Width="330" Height="30" VerticalAlignment="Bottom"
                                   Padding="4 8 4 0"
                                   Background="Azure">
                        </TextBox>
                    </DockPanel>
                    <DockPanel Margin="0 0 2 10" DockPanel.Dock="Top" Height="40">
                        <TextBlock DockPanel.Dock="Left" Text="WorkingDir: "
                                   Margin="0 0 5 0"
                                   Height="25" VerticalAlignment="Bottom"
                                   Padding="4" />
                        <TextBox DockPanel.Dock="Left"
                                   HorizontalAlignment="Left"
                                   Text="{Binding CurrentShortCut.Link, Mode=OneWay}"
                                   Width="330" Height="30" VerticalAlignment="Bottom"
                                   Padding="4 8 4 0"
                                   Background="Azure">
                        </TextBox>
                    </DockPanel>
                    <DockPanel Margin="0 0 2 10" DockPanel.Dock="Top" Height="40">
                        <TextBlock DockPanel.Dock="Left" Text="NetName: "
                                   Margin="0 0 5 0"
                                   Height="25" VerticalAlignment="Bottom"
                                   Padding="4" />
                        <TextBox DockPanel.Dock="Left"
                                   HorizontalAlignment="Left"
                                   Text="{Binding CurrentShortCut.NetName, Mode=OneWay}"
                                   Width="330" Height="30" VerticalAlignment="Bottom"
                                   Padding="4 8 4 0"
                                   Background="Azure">
                        </TextBox>
                    </DockPanel>
                    <DockPanel Margin="0 0 2 10" DockPanel.Dock="Top" Height="40">
                        <TextBlock DockPanel.Dock="Left" Text="DeviceName: "
                                   Margin="0 0 5 0"
                                   Height="25" VerticalAlignment="Bottom"
                                   Padding="4" />
                        <TextBox DockPanel.Dock="Left"
                                   HorizontalAlignment="Left"
                                   Text="{Binding CurrentShortCut.DeviceName, Mode=OneWay}"
                                   Width="330" Height="30" VerticalAlignment="Bottom"
                                   Padding="4 8 4 0"
                                   Background="Azure">
                        </TextBox>
                    </DockPanel>
                    <DockPanel Margin="0 0 2 10" DockPanel.Dock="Top" Height="40">
                        <TextBlock DockPanel.Dock="Left" Text="TargetUnicode: "
                                   Margin="0 0 5 0"
                                   Height="25" VerticalAlignment="Bottom"
                                   Padding="4" />
                        <TextBox DockPanel.Dock="Left"
                                   HorizontalAlignment="Left"
                                   Text="{Binding CurrentShortCut.TargetUnicode, Mode=OneWay}"
                                   Width="300" Height="30" VerticalAlignment="Bottom"
                                   Padding="4 8 4 0"
                                   Background="Azure">
                        </TextBox>
                    </DockPanel>
                    <DockPanel Margin="0 0 2 10" DockPanel.Dock="Top" Height="40">
                        <TextBlock DockPanel.Dock="Left" Text="Creation Date: "
                                   Height="25" 
                                   Padding="4" />
                        <TextBlock DockPanel.Dock="Left"
                                   Text="{Binding CurrentShortCut.CreationTime}"
                                   Margin="0 0 5 0"
                                   Width="200" Height="30"
                                   HorizontalAlignment="Left"
                                   VerticalAlignment="Center"
                                   Padding="4 8 4 0"
                                   Background="Azure">
                        </TextBlock>
                    </DockPanel>
                </StackPanel>
            </GroupBox>
            <GroupBox DockPanel.Dock="Bottom" Width="auto" Height="auto" Header="Редактировать">
                <StackPanel Orientation="Vertical">
                    <DockPanel Margin="0 0 2 10" DockPanel.Dock="Top" Height="40">
                    <TextBlock DockPanel.Dock="Left" Text="Все строки: "
                               Height="25" VerticalAlignment="Center"
                               Margin="0 0 10 0 "
                               Padding="4" />
                    <TextBox DockPanel.Dock="Left"
                               Text="{Binding SearchingString, Mode=TwoWay}"
                               Width="250" Height="30" VerticalAlignment="Center" HorizontalAlignment="Left"
                               Padding="4 8 4 0"
                               Background="Cornsilk">
                    </TextBox>
                    </DockPanel>
                    <DockPanel Margin="0 0 2 10" DockPanel.Dock="Top" Height="40">
                        <TextBlock DockPanel.Dock="Left" Text="Заменить на: "
                                   Height="25" VerticalAlignment="Center"
                                   Padding="4" />
                        <TextBox DockPanel.Dock="Left"
                                   Text="{Binding NewPartOfString, Mode=TwoWay}"
                                   Width="250" Height="30" VerticalAlignment="Center"
                                   Padding="4 8 4 0"
                                   Background="Cornsilk">
                        </TextBox>
                        <Button
                            DockPanel.Dock="Right"
                            Height="30"
                            Width="125"
                            VerticalAlignment="Center"
                            HorizontalAlignment="Left"
                            Margin="5 0 0 0 "
                            Content="Заменить и записать"
                            Command="{Binding FindReplaceAndRewriteLinkCommand}"
                            ToolTip="Все совпадения в свойствах ярлыка заменить на указанную подстроку" />
                    </DockPanel>
                </StackPanel>
            </GroupBox>
        </DockPanel>
        <DockPanel Grid.Column="1" Grid.Row="3" Grid.ColumnSpan="3" LastChildFill="True" Margin="0 0 2 0" Height="26" VerticalAlignment="Center">
            <StatusBar DockPanel.Dock="Top">
                <StatusBarItem MinWidth="150" MaxWidth="750" Height="auto" HorizontalAlignment="Left" VerticalAlignment="Center">
                    <TextBlock Text="{Binding CurrentDirectory,
                    UpdateSourceTrigger=PropertyChanged}" VerticalAlignment="Center"
                               HorizontalAlignment="Left" Height="auto"></TextBlock>
                </StatusBarItem>
            </StatusBar>
        </DockPanel>
    </Grid>
</Window>
